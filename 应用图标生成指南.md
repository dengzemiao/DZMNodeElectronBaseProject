# 📦 应用图标生成指南

## 🎯 问题说明

如果你运行 `npm run build:icons` 遇到 `TypeError: iconBuild is not a function` 错误，这是因为 `electron-icon-builder` 包的 API 可能有兼容性问题。

**不用担心！** 生成图标有很多简单的替代方法。

---

## ✅ 推荐方案：使用在线工具（最简单）

### 1️⃣ 准备源图标
- **尺寸**: 1024x1024 像素
- **格式**: PNG
- **背景**: 透明
- **内容**: 简洁清晰，预留约 10% 边距

### 2️⃣ 使用在线工具转换

#### 🌐 CloudConvert（推荐，支持所有格式）
网址：https://cloudconvert.com/

**步骤**：
1. 上传你的 1024x1024 PNG 图标
2. 选择转换格式：
   - PNG → ICNS（macOS）
   - PNG → ICO（Windows）
3. 下载转换后的文件
4. 重命名并放到项目中：
   ```
   build/icons/icon.icns  (macOS)
   build/icons/icon.ico   (Windows)
   build/icons/icon.png   (Linux，保持原 PNG)
   ```

#### 🎨 ConvertICO（专门转换 ICO）
网址：https://convertico.com/

**适用于**: Windows 图标
**步骤**: 上传 PNG → 下载 ICO → 放到 `build/icons/icon.ico`

#### 🛠️ iConvert Icons（多平台图标）
网址：https://iconverticons.com/

**功能**: 一次性生成所有平台图标
**步骤**: 上传图标 → 选择平台 → 批量下载

### 3️⃣ 放置图标文件

将生成的图标文件放到正确位置：

```
build/
└── icons/
    ├── icon.icns    ← macOS 图标
    ├── icon.ico     ← Windows 图标
    └── icon.png     ← Linux 图标（512x512 或 1024x1024）
```

### 4️⃣ 验证图标

运行检查命令：
```bash
npm run check:icons
```

如果显示 ✅ 全部就绪，就可以打包了：
```bash
npm run build
```

---

## 🍎 方案二：macOS 系统工具（仅适用于 Mac）

macOS 提供了内置的 `iconutil` 工具。

### 步骤

#### 1. 创建 iconset 目录
```bash
mkdir icon.iconset
```

#### 2. 准备多个尺寸的 PNG

使用 Sketch、Figma 或 Photoshop 导出以下尺寸：

```
icon.iconset/
├── icon_16x16.png
├── icon_16x16@2x.png     (32x32)
├── icon_32x32.png
├── icon_32x32@2x.png     (64x64)
├── icon_128x128.png
├── icon_128x128@2x.png   (256x256)
├── icon_256x256.png
├── icon_256x256@2x.png   (512x512)
├── icon_512x512.png
└── icon_512x512@2x.png   (1024x1024)
```

#### 3. 生成 ICNS
```bash
iconutil -c icns icon.iconset
```

#### 4. 移动到项目
```bash
mv icon.icns build/icons/icon.icns
```

---

## 🎨 方案三：使用设计工具

### Figma
1. 设计 1024x1024 图标
2. 使用插件：
   - **"Icons8 Background Remover"** - 去背景
   - **"Iconify"** - 导出多平台图标
3. 导出为 PNG，然后用在线工具转换

### Sketch
1. 设计图标
2. 导出时选择 "Export for iOS" 
3. 可以直接导出为 `.icns` 格式（macOS）
4. Windows 图标需要额外转换

### Adobe Photoshop
1. 安装 ICO 插件：**ICO Format Plugin**
2. 设计图标
3. 文件 → 存储为 → 选择 ICO 格式
4. macOS 图标需要用 iconutil 生成

---

## 🔧 方案四：修复 electron-icon-builder（进阶）

如果你确实想使用命令行工具，可以尝试：

### 选项 A：使用 app-icon
```bash
# 安装
npm install --save-dev app-icon

# 使用
npx app-icon generate -i source-icon.png -o build/icons
```

### 选项 B：使用 electron-icon-maker
```bash
# 安装
npm install --save-dev electron-icon-maker

# 在 scripts 中使用
const electronIconMaker = require('electron-icon-maker')

electronIconMaker({
  imageInput: './source-icon.png',
  imageOutput: './build/icons'
})
```

### 选项 C：使用 PNG 到 ICNS/ICO 转换库

```bash
npm install --save-dev png-to-ico
npm install --save-dev png2icons
```

但这些方案都需要额外配置，**不如直接使用在线工具简单快捷**。

---

## 📋 图标规格检查清单

### ✅ macOS (.icns)
- [ ] 格式：ICNS
- [ ] 包含尺寸：16, 32, 64, 128, 256, 512, 1024
- [ ] 文件大小：通常 100-500 KB
- [ ] 位置：`build/icons/icon.icns`

### ✅ Windows (.ico)
- [ ] 格式：ICO
- [ ] 包含尺寸：16, 24, 32, 48, 64, 128, 256
- [ ] 文件大小：通常 50-200 KB
- [ ] 位置：`build/icons/icon.ico`

### ✅ Linux (.png)
- [ ] 格式：PNG
- [ ] 尺寸：512x512 或 1024x1024
- [ ] 背景：透明
- [ ] 文件大小：通常 50-200 KB
- [ ] 位置：`build/icons/icon.png`

---

## 💡 实用命令

```bash
# 检查图标是否已准备好
npm run check:icons

# 尝试自动生成（可能失败）
npm run build:icons

# 如果图标都准备好了，开始打包
npm run build
npm run build:mac
npm run build:win
npm run build:linux
```

---

## 🆘 常见问题

### Q: 图标生成失败怎么办？
A: 使用在线工具手动生成是最可靠的方法。

### Q: 一定要所有平台的图标都准备吗？
A: 只需要准备你要打包的平台图标。比如只打包 macOS，只需要 icon.icns。

### Q: 可以使用 PNG 替代 ICNS 或 ICO 吗？
A: 不可以。macOS 必须用 .icns，Windows 必须用 .ico。

### Q: 图标尺寸不对会怎样？
A: 图标可能显示模糊或拉伸。建议严格按照规格制作。

### Q: 没有图标能打包吗？
A: 可以打包，但会使用系统默认图标（Electron 图标）。

---

## 🎯 推荐工作流程

```
1. 设计源图标 (1024x1024 PNG)
   ↓
2. 使用 CloudConvert 生成 ICNS + ICO
   ↓
3. 下载并放到 build/icons/
   ↓
4. 运行 npm run check:icons 验证
   ↓
5. 运行 npm run build 打包
```

---

**最简单的方法就是用在线工具！** 5 分钟搞定所有平台图标。🚀

